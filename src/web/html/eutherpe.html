<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" type="text/css" href="{{.URL-SCHEMA}}://{{.EUTHERPE-ADDR}}/css/eutherpe.css">
<script type="text/javascript" src="{{.URL-SCHEMA}}://{{.EUTHERPE-ADDR}}/js/eutherpe.js"></script>
</head>
<body>
    <div class="title-banner">{{.EUTHERPE}}</div>
    <div class="config">
        <button class="configtab" id="MusicButton" onclick="openConfig('Music')"><script>setButtonLabel("&#119066;&#119070;&#119066;", "Music");</script></button>
        <button class="configtab" id="CollectionButton" onclick="openConfig('Collection')"><script>setButtonLabel("&#9835;", "Collection");</script></button>
        <button class="configtab" id="PlaylistsButton" onclick="openConfig('Playlists')"><script>setButtonLabel("&#119046;&#119066;&#119047;", "Playlists");</script></button>
        <button class="configtab" id="StorageButton" onclick="openConfig('Storage')"><script>setButtonLabel("&#x1f4be;", "Storage");</script></button>
        <button class="configtab" id="BluetoothButton" onclick="openConfig('Bluetooth')"><script>setButtonLabel("&#128264;", "Bluetooth");</script></button>
    </div>
    <div id="Loading" class="configcontent" style="text-align: center; padding: 10%;">
        <p> Wait... &#x23F3; </p>
    </div>
    <div id="Music" class="configcontent">
        <div height=5px>
            <center>{{.ALBUM-ART-THUMBNAIL}}</center>
            <div class="marquee"><div id="playerStatusMarkee" class="nowplaying" >{{.NOW-PLAYING}}</div></div>
        </div>
        <div class="tinyscrollbox">
            <ul id="eutherpeUL">
                <li>
                    <span class="caret">Up next...</span>
                    {{.UP-NEXT}}
                </li>
            </ul>
        </div>
        <center>
            <hr>
            <input class="eutherpeBUTTON" type="button" value="Remove..." onclick="removeSelectedSongsFromUpNext();"/>
            <input class="eutherpeBUTTON" type="button" value="Move up" onclick="moveSelectedSongsFromUpNextUp();"/>
            <input class="eutherpeBUTTON" type="button" value="Move down" onclick="moveSelectedSongsFromUpNextDown();"/>
            <input class="eutherpeBUTTON" type="button" value="Clear all..." onclick="clearUpNextAll();"/>
            <input class="eutherpeBUTTON" type="button" value="{{.SHUFFLE-MODE}}" onclick="shuffleUpNext();"/>
            {{.REPEAT-ALL}}{{.REPEAT-ONE}}
            <hr>
            <input class="eutherpeBUTTON" type="button" id="playStop" value="{{.PLAY-MODE}}" onclick="musicPlayOrStop(this);"/>
            <input class="eutherpeBUTTON" type="button" value="Next" onclick="musicNext();"/>
        </center>
    </div>
    <div id="Collection" class="configcontent">
        <h3>Collection</h3>
        <div class="scrollbox">
            {{.COLLECTION}}
        </div>
        <center>
        <input class="eutherpeBUTTON" type="button" value="Add Selection to Next" onclick="addToNext();"/>
        <input class="eutherpeBUTTON" type="button" value="Add Selection to Up Next" onclick="addToUpNext();"/>
        <input class="eutherpeBUTTON" type="button" value="Add Selection to Playlist..." onclick="addToPlaylist();"/>
        <input class="eutherpeBUTTON" type="button" value="Tag Selection As..." onclick="tagSelectionAs();"/>
        </center>
    </div>
    <div id="Playlists" class="configcontent">
        <h3>Playlists</h3>
        <div class="scrollbox">
            {{.PLAYLISTS}}
        </div>
        <center>
        <input class="eutherpeBUTTON" type="button" value="Remove playlist..." onclick="removePlaylist();"/>
        <input class="eutherpeBUTTON" type="button" value="Clear all playlist..." onclick="clearAllPlaylist();"/>
        <input class="eutherpeBUTTON" type="button" value="Move up" onclick="moveUpPlaylistSongs();"/>
        <input class="eutherpeBUTTON" type="button" value="Move down" onclick="moveDownPlaylistSongs();"/>
        <input class="eutherpeBUTTON" type="button" value="Remove selected songs from playlist..." onclick="removeSelectedSongsFromPlaylist();"/>
        </center>
    </div>
    <div id="Storage" class="configcontent">
        <h3>You are reading your music collection from: {{.SELECTED-STORAGE-DEVICE}}</h3>
        <hr>
        <div class="hugescrollbox">
            <ul id="eutherpeUL">
                <li>
                    <span class="caret">Found Devices...</span>
                    {{.FOUND-STORAGE-DEVICES}}
                </li>
            </ul>
        </div>
        <center>
            <hr>
            <input class="eutherpeBUTTON" type="button" value="List storages" onclick="listStorageDevices();"/>
            <input class="eutherpeBUTTON" type="button" value="Scan selected storage" onclick="scanStorageDevice();"/>
            <input class="eutherpeBUTTON" type="button" value="Set storage" onclick="setStorageDevice();"/>
        </center>
    </div>
    </div>
    <div id="Bluetooth" class="configcontent">
        <h3>You are connected to device: {{.SELECTED-BLUETOOTH-DEVICE}}</h3>
        <hr>
        <div class="hugescrollbox">
            <ul id="eutherpeUL">
                <li>
                    <span class="caret">Found Devices...</span>
                    {{.FOUND-BLUETOOTH-DEVICES}}
                </li>
            </ul>
        </div>
        <center>
            <hr>
            <input class="eutherpeBUTTON" type="button" value="Probe devices" onclick="probeDevices();"/>
            <input class="eutherpeBUTTON" type="button" value="Pair..." onclick="pairDevice();"/>
            <input class="eutherpeBUTTON" type="button" value="Unpair..." onclick="unpairDevice();"/>
            <input class="eutherpeBUTTON" type="button" value="Trust..." onclick="trustDevice();"/>
            <input class="eutherpeBUTTON" type="button" value="Untrust..." onclick="untrustDevice();"/>
        </center>
    </div>
</body>

<script language="javascript">
function openConfig(configName) {
  // Declare all variables
  var i, configcontent, configtab;

  // Get all elements with class="tabcontent" and hide them
  configcontent = document.getElementsByClassName("configcontent");
  for (i = 0; i < configcontent.length; i++) {
    configcontent[i].style.display = "none";
  }

  // Get all elements with class="tablinks" and remove the class "active"
  configtab = document.getElementsByClassName("configtab");
  for (i = 0; i < configtab.length; i++) {
    configtab[i].className = configtab[i].className.replace(" active", "");
    configtab[i].innerHTML = configtab[i].innerHTML.replace(" &gt;", "");
  }

  // Show the current tab, and add an "active" class to the link that opened the tab
  document.getElementById(configName).style.display = "block";

  btn = document.getElementById(configName + "Button");
  if (btn === null) {
    return;
  }
  btn.className += " active";
  if (window.matchMedia("(orientation: landscape)").matches) {
    btn.innerHTML = btn.innerHTML + " &gt;";
  }
}


function flush_child(sender) {
    childs = document.getElementsByTagName("*");
    for (var c = 0; c < childs.length; c++) {
        if (childs[c].id.startsWith(sender.id)) {
            childs[c].checked = sender.checked;
        }
    }
}

var toggler = document.getElementsByClassName("caret");
var i;

for (i = 0; i < toggler.length; i++) {
    toggler[i].addEventListener("click", function() {
        this.parentElement.querySelector(".nested").classList.toggle("active");
        this.classList.toggle("caret-down");
        this.classList.down = !this.classList.down;
        if (document.getElementById("Music").style.display == "block") {
            albumCover = document.getElementById("albumCover");
            if (this.classList.down) {
                albumCover.width = 50;
                albumCover.height = 50;
            } else {
                albumCover.width = 125;
                albumCover.height = 125;
            }
        }
    });
}

openConfig("{{.CURRENT-CONFIG}}");

setInterval(() => {
    requestPlayerStatus();
}, 3000);

</script>

</html>
