<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" type="text/css" href="{{.URL-SCHEMA}}://{{.EUTHERPE-ADDR}}/css/eutherpe.css">
<script type="text/javascript" src="{{.URL-SCHEMA}}://{{.EUTHERPE-ADDR}}/js/eutherpe.js"></script>
<title>[Eutherpe]</title>
</head>
<body>
    <div class="title-banner">{{.EUTHERPE}}</div>
    <div class="config">
        <button class="configtab" id="MusicButton" onclick="openConfig('Music')"><script>setButtonLabel("&#x1F4FB", "Music");</script></button>
        <button class="configtab" id="CollectionButton" onclick="openConfig('Collection')"><script>setButtonLabel("&#x1F3B6;", "Collection");</script></button>
        <button class="configtab" id="PlaylistsButton" onclick="openConfig('Playlists')"><script>setButtonLabel("&#x1F352;", "Playlists");</script></button>
        <button class="configtab" id="StorageButton" onclick="openConfig('Storage')"><script>setButtonLabel("&#x1f4be;", "Storage");</script></button>
        <button class="configtab" id="BluetoothButton" onclick="openConfig('Bluetooth')"><script>setButtonLabel("&#128264;", "Bluetooth");</script></button>
    </div>
    <div id="Loading" class="configcontent" style="text-align: center; padding: 10%;">
        <p> Wait... &#x23F3; </p>
    </div>
    <div id="AddToPlaylist" class="configcontent" style="text-align: center; padding: 10%;">
        <b>Give me the name of an existing or new playlist...</b><br><br>
        <input type="text" id="playlistName" size="15%">
        <input class="eutherpeBUTTON" type="button" value="Add" onclick="addToPlaylist();">
        <input class="eutherpeBUTTON" type="button" value="Back" onclick="closeAddToPlaylist();">
    </div>
    <div id="AddTags" class="configcontent" style="text-align: center; padding: 10%;">
        <b>Give me the tag or a bunch separated by commas...</b><br><br>
        <input type="text" id="tagsSet" size="15%">
        <input class="eutherpeBUTTON" type="button" value="Add" onclick="addTagsToSelection();">
        <input class="eutherpeBUTTON" type="button" value="Back" onclick="closeAddTags();">
    </div>
    <div id="RemoveTags" class="configcontent" style="text-align: center; padding: 1%;">
        <b>Uncheck the tags you want to remove from your song selection...</b><br><br>
        <div class="hugescrollbox" style="text-align: left;">
            <ul id="eutherpeUL">
                <li>
                    <span class="caret">Available tags</span>
                    {{.COMMON-TAGS}}
                </li>
            </ul>
        </div>
        <input class="eutherpeBUTTON" type="button" value="Save" onclick="delTagsFromSelection();">
        <input class="eutherpeBUTTON" type="button" value="Back" onclick="closeRemoveTags();">
    </div>
    <div id="PlayByTags" class="configcontent" style="text-align: center; padding: 5%;">
        <b>Give me a tag or a bunch separated by commas and I will find it to play...</b><br><br>
        <input type="text" id="tagsCtx" size="60%"><br><br>
        <b>Now, how many songs you are intending to listen?</b><br><br>
        <input type="number" id="songsAmount" min="1" size="15%" step="1" value="1">
        <input class="eutherpeBUTTON" type="button" value="Play" onclick="playByGivenTags();">
        <input class="eutherpeBUTTON" type="button" value="Back" onclick="closePlayByTags();">
    </div>
    <div id="Music" class="configcontent">
        <div class="AlbumCover" id="AlbumCoverDiv">{{.ALBUM-ART-THUMBNAIL}}</div>
        <div class="NowPlaying" id="NowPlayingDiv">{{.NOW-PLAYING}}</div>
        <div class="tinyscrollbox">
            <ul id="eutherpeUL">
                <li>
                    <span class="caret">Up next...</span>
                    {{.UP-NEXT}}
                </li>
            </ul>
        </div>
        <center>
            <hr>
            <input class="eutherpeBUTTON" type="button" value="&#x226A" onclick="musicLast();"/>
            <input class="eutherpeBUTTON" type="button" id="playStop" value="{{.PLAY-MODE}}" onclick="musicPlayOrStop(this);"/>
            <input class="eutherpeBUTTON" type="button" value="&#x226B" onclick="musicNext();"/>
            <input class="eutherpeBUTTON" type="button" value="&#x23F6" onclick="moveSelectedSongsFromUpNextUp();"/>
            <input class="eutherpeBUTTON" type="button" value="&#x23F7" onclick="moveSelectedSongsFromUpNextDown();"/>
            <input class="eutherpeBUTTON" type="button" value="{{.SHUFFLE-MODE}}" onclick="shuffleUpNext();"/>
            <input class="eutherpeBUTTON" type="button" value="Remove..." onclick="removeSelectedSongsFromUpNext();"/>
            <input class="eutherpeBUTTON" type="button" value="Clear all..." onclick="clearUpNextAll();"/>
            <hr>
            <input class="eutherpeRANGE" type="range" id="volumeLevel" min="0" max="100" step="1" value="{{.VOLUME-LEVEL}}" onclick="setVolume();"/>{{.REPEAT-ALL}}{{.REPEAT-ONE}}
        </center>
    </div>
    <div id="Collection" class="configcontent">
        <h3>&#x1F3B6; Collection</h3>
        <div class="scrollbox">
            {{.COLLECTION}}
        </div>
        <center>
        <input class="eutherpeBUTTON" type="button" value="Add to Next" onclick="addToNext();"/>
        <input class="eutherpeBUTTON" type="button" value="Add to Up Next" onclick="addToUpNext();"/>
        <input class="eutherpeBUTTON" type="button" value="Add to Playlist..." onclick="openConfig('AddToPlaylist');"/>
        <hr>
        <input class="eutherpeBUTTON" type="button" value="Add tags..." onclick="showAddTags();"/>
        <input class="eutherpeBUTTON" type="button" value="Del tags..." onclick="showRemoveTagsDiv();"/>
        <input class="eutherpeBUTTON" type="button" value="Play tagged..." onclick="showPlayByTags();"/>
        </center>
    </div>
    <div id="Playlists" class="configcontent">
        <h3>&#x1F352; Playlists</h3>
        <div class="scrollbox">
            {{.PLAYLISTS}}
        </div>
        <center>
        <hr>
        <input class="eutherpeBUTTON" type="button" value="Remove..." onclick="removePlaylist();"/>
        <input class="eutherpeBUTTON" type="button" value="Clear..." onclick="clearAllPlaylist();"/>
        <input class="eutherpeBUTTON" type="button" value="Songs up" onclick="moveUpPlaylistSongs();"/>
        <input class="eutherpeBUTTON" type="button" value="Songs down" onclick="moveDownPlaylistSongs();"/>
        <input class="eutherpeBUTTON" type="button" value="Remove songs..." onclick="removeSelectedSongsFromPlaylist();"/>
        <hr>
        <input class="eutherpeBUTTON" type="button" value="Reproduce" onclick="reproducePlaylist();"/>
        <input class="eutherpeBUTTON" type="button" value="Reproduce selection" onclick="reproduceSelectedOnesFromPlaylist();"/>
        </center>
    </div>
    <div id="Storage" class="configcontent">
        <h3>&#x1f4be; You are reading your music collection from: {{.SELECTED-STORAGE-DEVICE}}</h3>
        <hr>
        <div class="hugescrollbox">
            <ul id="eutherpeUL">
                <li>
                    <span class="caret">Found Devices...</span>
                    {{.FOUND-STORAGE-DEVICES}}
                </li>
            </ul>
        </div>
        <center>
            <hr>
            <input class="eutherpeBUTTON" type="button" value="List" onclick="listStorageDevices();"/>
            <input class="eutherpeBUTTON" type="button" value="Set" onclick="setStorageDevice();"/>
            <input class="eutherpeBUTTON" type="button" value="Scan" onclick="scanStorageDevice();"/>
        </center>
    </div>
    </div>
    <div id="Bluetooth" class="configcontent">
        <h3>&#128264; You are connected to device: {{.SELECTED-BLUETOOTH-DEVICE}}</h3>
        <hr>
        <div class="hugescrollbox">
            <ul id="eutherpeUL">
                <li>
                    <span class="caret">Found Devices...</span>
                    {{.FOUND-BLUETOOTH-DEVICES}}
                </li>
            </ul>
        </div>
        <center>
            <hr>
            <input class="eutherpeBUTTON" type="button" value="Probe" onclick="probeDevices();"/>
            <input class="eutherpeBUTTON" type="button" value="Pair..." onclick="pairDevice();"/>
            <input class="eutherpeBUTTON" type="button" value="Unpair..." onclick="unpairDevice();"/>
        </center>
    </div>
    <input type="hidden" id="lastSelection" name="lastSelection" value="{{.LAST-SELECTION}}"/>
</body>

<script language="javascript">
function openConfig(configName) {
  // Declare all variables
  var i, configcontent, configtab;

  // Get all elements with class="tabcontent" and hide them
  configcontent = document.getElementsByClassName("configcontent");
  for (i = 0; i < configcontent.length; i++) {
    configcontent[i].style.display = "none";
  }

  // Get all elements with class="tablinks" and remove the class "active"
  configtab = document.getElementsByClassName("configtab");
  for (i = 0; i < configtab.length; i++) {
    configtab[i].className = configtab[i].className.replace(" active", "");
    configtab[i].innerHTML = configtab[i].innerHTML.replace(" &gt;", "");
  }

  // Show the current tab, and add an "active" class to the link that opened the tab
  document.getElementById(configName).style.display = "block";

  btn = document.getElementById(configName + "Button");
  if (btn === null) {
    return;
  }
  btn.className += " active";
  if (window.matchMedia("(orientation: landscape)").matches) {
    btn.innerHTML = btn.innerHTML + " &gt;";
  }
}


function flush_child(sender) {
    childs = document.getElementsByTagName("*");
    for (var c = 0; c < childs.length; c++) {
        if (childs[c].id.startsWith(sender.id)) {
            childs[c].checked = sender.checked;
        }
    }
}

var toggler = document.getElementsByClassName("caret");
var i;

for (i = 0; i < toggler.length; i++) {
    toggler[i].addEventListener("click", function() {
        this.parentElement.querySelector(".nested").classList.toggle("active");
        this.classList.toggle("caret-down");
        this.classList.down = !this.classList.down;
        if (document.getElementById("Music").style.display == "block") {
            albumCover = document.getElementById("albumCover");
            if (this.classList.down) {
                albumCover.width = 50;
                albumCover.height = 50;
            } else {
                albumCover.width = 125;
                albumCover.height = 125;
            }
        }
    });
}

openConfig("{{.CURRENT-CONFIG}}");

setInterval(() => {
    requestPlayerStatus();
}, 3000);

</script>

</html>
